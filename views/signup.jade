extends layout

block default_nav
  a.login.user-pill.pull-left(href="/") Home
  a.login.user-pill.pull-left(href="/login") Login

block extra_head
  script(src="https://www.google.com/recaptcha/api.js?onload=vcRecaptchaApiLoaded&render=explicit" async defer)

block content
  script.
    require([
        'angular-recaptcha',
        'controllers/signup',
        'directives/password.check',
        'directives/password.strength'
      ],
      function (
        vcRecaptcha, SignUpController,
        passwordCheck, passwordStrength) {

        angular.module('voxboneApp', ['vcRecaptcha'])
          .directive('pwCheck', passwordCheck)
          .directive('passwordStrength', passwordStrength)
          .controller('SignUpController', SignUpController);

        angular.bootstrap(document, ['voxboneApp']);
      }
    );

  .main.registerPage
    .body
      .container
        .row
          .col-sm-12
            h1 Create Account

            #alert-error.alert.alert-danger.hidden
            #alert-info.alert.alert-info.hidden

            #form_container
              p.
                #[b Note for current Voxbone customers:] your click2vox.com login will not be linked to your existing Voxbone account. To use your Voxbone account and an existing DID, please visit #[a(href="https://developers.voxbone.com/how-to/setup-webrtc/") view instructions]

              .formWrap
                form#create_account(ng-controller="SignUpController" name="create_account" ng-init="account.uemail='#{email|| ''}'" novalidate)
                  .form-group
                    label.control-label Name
                    input.form-control(type="text" id="uname" name="uname" ng-model="account.uname" required)
                    .error-label(ng-show="create_account.$submitted || create_account.uname.$touched")
                      .ng-hide(ng-show="create_account.uname.$error.required") Please enter your name
                  .form-group
                    label.control-label Company
                    input.form-control(type="text" id="ucompany" name="ucompany" ng-model="account.ucompany")
                  .form-group
                    label.control-label Email address
                    input.form-control(type="text" id="uemail" name="uemail" ng-model="account.uemail" required)
                    .error-label(ng-show="create_account.$submitted || create_account.uemail.$touched")
                      .ng-hide(ng-show="create_account.uemail.$error.required") Email is required
                  .form-group
                    label.control-label Password
                    input.form-control(type="password" id="upassword" name="upassword" ng-model="account.upassword" required password-strength="account.upassword")
                    .progress.passwordStrength.ng-hide(ng-show="create_account.upassword.$dirty")
                      .progress-bar(role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: {{strength_percent}}%" class="{{strength_class}}")
                        span Strength: {{strength}}!
                    .error-label(ng-show="create_account.$submitted || create_account.upassword.$touched")
                      .ng-hide(ng-show="create_account.upassword.$error.required") Password is required
                      .ng-hide(ng-show="create_account.upassword.$error.minlength") Password must be at least 8 characters in length
                  .form-group
                    label.control-label Confirm Password
                    input.form-control(type="password" id="confirmation" name="confirmation" ng-model="account.confirmation" required pw-check="upassword")
                    .error-label(ng-show="create_account.$submitted || create_account.confirmation.$touched")
                      .ng-hide(ng-show="create_account.confirmation.$error.pwmatch") Password confirmation does not match

                  .form-group.text-center
                    .captcha(ng-model="account.recaptcha" vc-recaptcha key='"#{process.env.GOOGLE_RECAPTCHA_SITE_KEY}"' on-create="setWidgetId(widgetId)")

                  .form-group
                    label.control-label
                      span You must accept our #[a(href="#{process.env.APP_URL}/docs/click2vox-aup.pdf") User Policy]
                      span &nbsp;
                      input(type="checkbox" id="uaup" name="uaup" ng-model="account.uaup" required)

                  button.btn.btn-default#create(ng-disabled="create_account.$invalid" ng-click="processForm()") Create Account
                  br
                  p Already have a click2vox.com account? #[a(href="../login") Login here]
